{% extends "base.html" %}

{% block title %}{{ module }} Help - {{ section|title }}{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/help">Help Center</a></li>
                    <li class="breadcrumb-item"><a href="/help?module={{ module }}">{{ module }}</a></li>
                    <li class="breadcrumb-item active">{{ section|title }}</li>
                </ol>
            </nav>

            <!-- Dynamic Help Content -->
            {% if module == 'Admin' and section == 'overview' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-tachometer-alt me-2"></i>Admin Dashboard Overview</h3>
                    </div>
                    <div class="card-body">
                        <h5>Dashboard Navigation</h5>
                        <p>The Admin Dashboard provides a comprehensive overview of your DeciFrame system:</p>
                        <ul>
                            <li><strong>Key Metrics Cards:</strong> Monitor users, departments, business cases, and projects</li>
                            <li><strong>Pending Reviews:</strong> Track items requiring admin attention</li>
                            <li><strong>Quick Actions:</strong> Access frequently used admin functions</li>
                            <li><strong>System Health:</strong> Monitor system performance and alerts</li>
                        </ul>
                        
                        <h5>Getting Started</h5>
                        <ol>
                            <li>Review the key metrics to understand your organization's current state</li>
                            <li>Check pending reviews for items requiring immediate attention</li>
                            <li>Use Quick Actions for common administrative tasks</li>
                            <li>Monitor system health indicators for any issues</li>
                        </ol>
                    </div>
                </div>

            {% elif module == 'Admin' and section == 'users' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-users me-2"></i>User Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>User Roles in DeciFrame</h5>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Role</th>
                                        <th>Permissions</th>
                                        <th>Key Responsibilities</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge bg-danger">Admin</span></td>
                                        <td>Full system access</td>
                                        <td>System configuration, user management, organization settings</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-warning">Director</span></td>
                                        <td>Department oversight</td>
                                        <td>Business case approval, departmental reporting</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-primary">Manager</span></td>
                                        <td>Team management</td>
                                        <td>Team oversight, problem escalation</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-success">BA</span></td>
                                        <td>Business analysis</td>
                                        <td>Business case development, requirements analysis</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-info">PM</span></td>
                                        <td>Project management</td>
                                        <td>Project execution, milestone tracking</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-secondary">Staff</span></td>
                                        <td>Basic access</td>
                                        <td>Problem reporting, task completion</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <h5>Creating New Users</h5>
                        <ol>
                            <li>Navigate to Admin → Manage Users</li>
                            <li>Click "Create User" button</li>
                            <li>Fill in user details (name, email, role)</li>
                            <li>Assign to appropriate department</li>
                            <li>Set initial password (user will be prompted to change)</li>
                        </ol>
                    </div>
                </div>

            {% elif module == 'Admin' and section == 'departments' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-building me-2"></i>Department Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>Organizational Structure</h5>
                        <p>Departments in DeciFrame support up to 5 hierarchical levels for complex organizational structures:</p>
                        <ul>
                            <li><strong>Parent-Child Relationships:</strong> Create nested department structures</li>
                            <li><strong>Department Heads:</strong> Assign managers to oversee department operations</li>
                            <li><strong>User Assignment:</strong> Associate users with their appropriate departments</li>
                            <li><strong>Reporting Hierarchy:</strong> Enable role-based dashboards and filtering</li>
                        </ul>
                        
                        <h5>Creating Departments</h5>
                        <ol>
                            <li>Navigate to Admin → Organization Structure</li>
                            <li>Click "Add Department" button</li>
                            <li>Enter department name and description</li>
                            <li>Select parent department (if applicable)</li>
                            <li>Assign department head (Manager or Director role)</li>
                        </ol>
                        
                        <div class="alert alert-info">
                            <strong>Best Practice:</strong> Keep department structures logical and aligned with your organization's actual hierarchy for optimal workflow management.
                        </div>
                    </div>
                </div>

            {% elif module == 'Business' and section == 'cases' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-briefcase me-2"></i>Business Case Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>Business Case Types</h5>
                        <p>DeciFrame supports both Reactive and Proactive business cases:</p>
                        <ul>
                            <li><strong>Reactive Cases:</strong> Created from identified problems requiring solutions</li>
                            <li><strong>Proactive Cases:</strong> Initiative-driven improvements and innovations</li>
                            <li><strong>Light Cases:</strong> Quick assessment for smaller investments (&lt; $25,000)</li>
                            <li><strong>Full Cases:</strong> Comprehensive analysis for major investments</li>
                        </ul>
                        
                        <h5>Business Case Workflow</h5>
                        <ol>
                            <li><strong>Submission:</strong> Staff submit business case requests</li>
                            <li><strong>BA Assignment:</strong> Business Analysts are automatically assigned</li>
                            <li><strong>Development:</strong> BAs develop comprehensive business cases with ROI calculations</li>
                            <li><strong>Director Approval:</strong> Directors review and approve/reject cases</li>
                            <li><strong>Project Conversion:</strong> Approved cases convert to managed projects</li>
                        </ol>
                    </div>
                </div>

            {% elif module == 'Projects' and section == 'management' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-project-diagram me-2"></i>Project Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>Project Lifecycle</h5>
                        <p>Projects in DeciFrame progress through structured phases:</p>
                        <ul>
                            <li><strong>Initiation:</strong> Projects created from approved business cases</li>
                            <li><strong>Planning:</strong> Project Managers define milestones and timelines</li>
                            <li><strong>Execution:</strong> Teams work towards milestone completion</li>
                            <li><strong>Monitoring:</strong> ML-powered success prediction and risk assessment</li>
                            <li><strong>Closure:</strong> Project completion and lessons learned</li>
                        </ul>
                        
                        <h5>Milestone Management</h5>
                        <ol>
                            <li>Break projects into measurable milestones</li>
                            <li>Set realistic due dates and assign resources</li>
                            <li>Track progress with regular updates</li>
                            <li>Use predictive analytics for risk identification</li>
                        </ol>
                        
                        <div class="alert alert-success">
                            <strong>AI Enhancement:</strong> DeciFrame uses machine learning to predict project success and identify potential risks before they become critical.
                        </div>
                    </div>
                </div>

            {% elif module == 'Admin' and section == 'triage' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-cogs me-2"></i>Triage Rules Configuration</h3>
                    </div>
                    <div class="card-body">
                        <h5>Automated Business Process Rules</h5>
                        <p>Triage rules automate workflow decisions based on configurable criteria:</p>
                        <ul>
                            <li><strong>Assignment Rules:</strong> Automatically assign business cases to appropriate BAs</li>
                            <li><strong>Escalation Rules:</strong> Escalate overdue items to managers or directors</li>
                            <li><strong>Notification Rules:</strong> Send alerts based on priority and timeframes</li>
                            <li><strong>Approval Routing:</strong> Route cases to appropriate approval levels</li>
                        </ul>
                        
                        <h5>Rule Configuration</h5>
                        <ol>
                            <li>Navigate to Admin → Triage Rules</li>
                            <li>Click "Create Rule" button</li>
                            <li>Define trigger conditions (priority, value, department)</li>
                            <li>Set actions (assign, escalate, notify)</li>
                            <li>Test rule with dry run before activation</li>
                        </ol>
                        
                        <div class="alert alert-warning">
                            <strong>Important:</strong> Test triage rules carefully in development before applying to production workflows to avoid unintended automation.
                        </div>
                    </div>
                </div>

            {% elif module == 'Problems' and section == 'management' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>Problem Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>Problem Identification & Tracking</h5>
                        <p>Problems in DeciFrame are systematically tracked from identification to resolution:</p>
                        <ul>
                            <li><strong>Problem Reporting:</strong> Staff can submit problems they've identified</li>
                            <li><strong>Automatic Coding:</strong> System assigns unique codes (P0001, P0002, etc.)</li>
                            <li><strong>Priority Classification:</strong> Low, Medium, High, Critical priority levels</li>
                            <li><strong>Status Tracking:</strong> Open, In Review, Being Addressed, Resolved</li>
                        </ul>
                        
                        <h5>Problem-to-Business Case Workflow</h5>
                        <ol>
                            <li>Problem submitted by staff member</li>
                            <li>Automatic triage based on priority and impact</li>
                            <li>Manager or BA reviews problem details</li>
                            <li>If solution requires investment, converts to business case</li>
                            <li>Problem tracks business case progress through resolution</li>
                        </ol>
                        
                        <div class="alert alert-info">
                            <strong>Integration:</strong> Problems seamlessly link to business cases and projects, providing complete visibility from issue identification to resolution.
                        </div>
                    </div>
                </div>

            {% elif module == 'Admin' and section == 'quick-actions' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-bolt me-2"></i>Admin Quick Actions</h3>
                    </div>
                    <div class="card-body">
                        <h5>System Management</h5>
                        <p>The Quick Actions panel provides direct access to core administrative functions:</p>
                        <ul>
                            <li><strong>Manage Users:</strong> Create, edit, and manage user accounts and roles</li>
                            <li><strong>Triage Rules:</strong> Configure automated workflow rules and business process logic</li>
                            <li><strong>Audit Trail:</strong> Review system activity logs and user actions</li>
                            <li><strong>System Health:</strong> Monitor application performance and system status</li>
                        </ul>
                        
                        <h5>Configuration</h5>
                        <ul>
                            <li><strong>Organization:</strong> Update organization settings, preferences, and themes</li>
                            <li><strong>Notifications:</strong> Configure email alerts and notification templates</li>
                            <li><strong>Permissions:</strong> Manage role-based access control and security settings</li>
                            <li><strong>Workflows:</strong> Configure workflow templates and automation rules</li>
                        </ul>
                        
                        <h5>Data Management</h5>
                        <ul>
                            <li><strong>Import Data:</strong> Bulk import users, departments, and organizational data</li>
                            <li><strong>Export Data:</strong> Generate reports and export organizational information</li>
                            <li><strong>Backup:</strong> Create data backups and manage data retention</li>
                        </ul>
                        
                        <div class="alert alert-success">
                            <strong>Pro Tip:</strong> Quick Actions are organized by function type - use System Management for daily operations, Configuration for setup, and Data Management for imports/exports.
                        </div>
                    </div>
                </div>

            {% elif module == 'Admin' and section == 'users' %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0"><i class="fas fa-users me-2"></i>User Management</h3>
                    </div>
                    <div class="card-body">
                        <h5>User Roles & Permissions</h5>
                        <p>DeciFrame supports 6 distinct user roles with specific permissions:</p>
                        <ul>
                            <li><strong>Admin:</strong> Full system access and configuration</li>
                            <li><strong>Director:</strong> Department oversight and business case approval</li>
                            <li><strong>Manager:</strong> Team management and problem review</li>
                            <li><strong>BA (Business Analyst):</strong> Business case development and analysis</li>
                            <li><strong>PM (Project Manager):</strong> Project execution and milestone tracking</li>
                            <li><strong>Staff:</strong> Problem reporting and basic system access</li>
                        </ul>
                        
                        <h5>User Creation Process</h5>
                        <ol>
                            <li>Navigate to Admin → Manage Users</li>
                            <li>Click "Create User" button</li>
                            <li>Enter user details (name, email, role)</li>
                            <li>Assign to appropriate department</li>
                            <li>Set manager (if applicable)</li>
                            <li>User receives welcome email with login instructions</li>
                        </ol>
                        
                        <div class="alert alert-warning">
                            <strong>Security:</strong> Only business email addresses are accepted. Personal email domains (gmail, yahoo, etc.) are automatically blocked for security compliance.
                        </div>
                    </div>
                </div>

            {% else %}
                <!-- Generic help content for unmatched sections -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0">{{ module }} - {{ section|title }}</h3>
                    </div>
                    <div class="card-body">
                        <p>Help content for this section is being developed. Please check back soon or contact your administrator for assistance.</p>
                        
                        <div class="mt-4">
                            <a href="/help" class="btn btn-primary">
                                <i class="fas fa-arrow-left me-2"></i>Back to Help Center
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}

            <!-- Quick Links -->
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body text-center">
                            <h6>Need More Help?</h6>
                            <a href="/help" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-book me-1"></i>Browse All Articles
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body text-center">
                            <h6>Can't Find What You Need?</h6>
                            <button class="btn btn-outline-success btn-sm" onclick="alert('Contact feature coming soon!')">
                                <i class="fas fa-envelope me-1"></i>Contact Support
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}